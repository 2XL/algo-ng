<array>
{% if algo_ondemand_wifi_exclude != '_null' %}
{% set WIFI_EXCLUDE_LIST = (algo_ondemand_wifi_exclude|string).split(',') %}
    <dict>
        <key>Action</key>
        <string>Disconnect</string>
        <key>InterfaceTypeMatch</key>
        <string>WiFi</string>
        <key>SSIDMatch</key>
        <array>
{% for network_name in WIFI_EXCLUDE_LIST %}
            <string>{{ network_name|e }}</string>
{% endfor %}
        </array>
    </dict>
{% else %}
{% endif %}
    <dict>
      <key>Action</key>
{% if algo_ondemand_wifi %}
        <string>Connect</string>
{% else %}
        <string>Disconnect</string>
{% endif %}
      <key>InterfaceTypeMatch</key>
        <string>WiFi</string>
      <key>URLStringProbe</key>
        <string>http://captive.apple.com/hotspot-detect.html</string>
    </dict>
    <dict>
      <key>Action</key>
{% if algo_ondemand_cellular %}
        <string>Connect</string>
{% else %}
        <string>Disconnect</string>
{% endif %}
      <key>InterfaceTypeMatch</key>
        <string>Cellular</string>
      <key>URLStringProbe</key>
        <string>http://captive.apple.com/hotspot-detect.html</string>
    </dict>
  </array>
{% else %}
{% endif %}
